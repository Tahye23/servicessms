<div class="min-h-screen flex items-center justify-center bg-gray-100 px-4">
  <div class="w-full max-w-sm bg-white rounded-2xl shadow-lg p-8">
    <h1 class="text-2xl font-semibold text-gray-800 mb-6" jhiTranslate="reset.finish.title">Réinitialisation du mot de passe</h1>

    <!-- Clef manquante -->
    <ng-container *ngIf="initialized() && !key()">
      <div class="mb-4 p-4 bg-red-50 border-l-4 border-red-500 text-red-700 rounded">
        <span jhiTranslate="reset.finish.messages.keymissing"> La clef de réinitialisation est manquante </span>
      </div>
    </ng-container>

    <!-- Invitation à choisir un nouveau mot de passe -->
    <ng-container *ngIf="key() && !success()">
      <div class="mb-4 p-4 bg-yellow-50 border-l-4 border-yellow-400 text-yellow-700 rounded">
        <span jhiTranslate="reset.finish.messages.info"> Choisir un nouveau mot de passe </span>
      </div>
    </ng-container>

    <!-- Erreur (lien expiré) -->
    <ng-container *ngIf="error()">
      <div class="mb-4 p-4 bg-red-50 border-l-4 border-red-500 text-red-700 rounded">
        <span jhiTranslate="reset.finish.messages.error">
          Votre mot de passe n'a pas pu être réinitialisé. La demande de réinitialisation n'est valable que 24 heures.
        </span>
      </div>
    </ng-container>

    <!-- Succès -->
    <ng-container *ngIf="success()">
      <div class="mb-4 p-4 bg-green-50 border-l-4 border-green-400 text-green-700 rounded">
        <span jhiTranslate="reset.finish.messages.success"> <strong>Votre mot de passe a été réinitialisé.</strong> Merci de </span>
        <a class="text-green-800 underline ml-1" routerLink="/login" jhiTranslate="global.messages.info.authenticated.link"> connecter </a>.
      </div>
    </ng-container>

    <!-- Mot de passe et confirmation non identiques -->
    <ng-container *ngIf="doNotMatch()">
      <div class="mb-4 p-4 bg-red-50 border-l-4 border-red-500 text-red-700 rounded" jhiTranslate="global.messages.error.dontmatch">
        Le nouveau mot de passe et sa confirmation ne sont pas égaux !
      </div>
    </ng-container>

    <!-- Formulaire de réinitialisation -->
    <ng-container *ngIf="key() && !success()">
      <form name="form" (ngSubmit)="finishReset()" [formGroup]="passwordForm" novalidate>
        <!-- Nouveau mot de passe -->
        <div class="mb-5">
          <label for="newPassword" class="block text-gray-700 mb-2" jhiTranslate="global.form.newpassword.label">
            Nouveau mot de passe
          </label>
          <input
            type="password"
            id="newPassword"
            name="newPassword"
            formControlName="newPassword"
            placeholder="{{ 'global.form.newpassword.placeholder' | translate }}"
            data-cy="resetPassword"
            #newPassword
            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
          />
          <div
            *ngIf="
              passwordForm.get('newPassword')!.invalid &&
              (passwordForm.get('newPassword')!.dirty || passwordForm.get('newPassword')!.touched)
            "
            class="mt-2 space-y-1"
          >
            <small
              class="block text-red-600"
              *ngIf="passwordForm.get('newPassword')?.errors?.required"
              jhiTranslate="global.messages.validate.newpassword.required"
            >
              Votre mot de passe est requis.
            </small>
            <small
              class="block text-red-600"
              *ngIf="passwordForm.get('newPassword')?.errors?.minlength"
              jhiTranslate="global.messages.validate.newpassword.minlength"
            >
              Votre mot de passe doit comporter au moins 4 caractères.
            </small>
            <small
              class="block text-red-600"
              *ngIf="passwordForm.get('newPassword')?.errors?.maxlength"
              jhiTranslate="global.messages.validate.newpassword.maxlength"
            >
              Votre mot de passe ne doit pas comporter plus de 50 caractères.
            </small>
          </div>
          <jhi-password-strength-bar [passwordToCheck]="passwordForm.get('newPassword')!.value"></jhi-password-strength-bar>
        </div>

        <!-- Confirmation du mot de passe -->
        <div class="mb-5">
          <label for="confirmPassword" class="block text-gray-700 mb-2" jhiTranslate="global.form.confirmpassword.label">
            Confirmation du nouveau mot de passe
          </label>
          <input
            type="password"
            id="confirmPassword"
            name="confirmPassword"
            formControlName="confirmPassword"
            placeholder="{{ 'global.form.confirmpassword.placeholder' | translate }}"
            data-cy="confirmResetPassword"
            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
          />
          <div
            *ngIf="
              passwordForm.get('confirmPassword')!.invalid &&
              (passwordForm.get('confirmPassword')!.dirty || passwordForm.get('confirmPassword')!.touched)
            "
            class="mt-2 space-y-1"
          >
            <small
              class="block text-red-600"
              *ngIf="passwordForm.get('confirmPassword')?.errors?.required"
              jhiTranslate="global.messages.validate.confirmpassword.required"
            >
              Votre confirmation du mot de passe est requise.
            </small>
            <small
              class="block text-red-600"
              *ngIf="passwordForm.get('confirmPassword')?.errors?.minlength"
              jhiTranslate="global.messages.validate.confirmpassword.minlength"
            >
              Votre confirmation du mot de passe doit comporter au moins 4 caractères.
            </small>
            <small
              class="block text-red-600"
              *ngIf="passwordForm.get('confirmPassword')?.errors?.maxlength"
              jhiTranslate="global.messages.validate.confirmpassword.maxlength"
            >
              Votre confirmation du mot de passe ne doit pas comporter plus de 50 caractères.
            </small>
          </div>
        </div>

        <button
          type="submit"
          [disabled]="passwordForm.invalid"
          class="w-full py-3 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition disabled:opacity-50 disabled:cursor-not-allowed"
          data-cy="submit"
          jhiTranslate="reset.finish.form.button"
        >
          Réinitialiser le mot de passe
        </button>
      </form>
    </ng-container>
  </div>
</div>
